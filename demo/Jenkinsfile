pipeline {
    agent any
     stages {
        stage('Initialize') {
            steps {
                echo 'setting...'   
                 bat 'set'
            }
        }
       stage('build') {
          steps {                                
             bat 'echo building....'
             bat 'gradle clean build'
               bat 'echo builded....'    
            
          }
       }
    
stage('Sonarqube analysis') {
    steps {
   echo "sonar report"
  script {
          // requires SonarQube Scanner 2.8+
          scannerHome = tool 'sonar'
        }
  
       
     withSonarQubeEnv('clsd') {
         echo scannerHome
         bat "${scannerHome}/bin/sonar-scanner.bat\
         -Dsonar.projectKey=clsd\
         -Dsonar.projectName=clsd\
         -Dsonar.jacoco.reportPaths=${WORKSPACE}/demo/build/jacoco/test.exec \
         -Dsonar.junit.reportPaths=${WORKSPACE}/demo/build/test-results/test \
         -Dsonar.java.binaries=${WORKSPACE}/demo/build/classes/java/main \
         -Dsonar.sources=${WORKSPACE}/demo/src \
         -Dsonar.tests=${WORKSPACE}/demo/src/test \
         -Dsonar.test.inclusions=**/*Test.java"


    }
    }
        }
    }
    post { 
        always { 
           
             echo 'DONE!'
        }
    }
}
