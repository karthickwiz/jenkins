pipeline {
    agent any
     parameters {        
    	choice(name: 'ENVIRONMENT', choices: 'DEVELOPMENT\nTEST\nSTAGING_WTC\nSTAGING_EDC\nPRODUCTION_WTC\nPRODUCTION_EDC', description: 'In which Environment?')
     }
    stages {
        stage('Initialize') {
            steps {
                echo 'setting...'   
                 bat 'set'
            }
        }
       stage('build') {
          steps {
              
             bat 'echo ENVIRONMENT'
              
             bat 'echo building....'
             bat 'gradle build'
               bat 'echo builded....'    
            
          }
       }
        stage('try') {
          steps {
             bat 'echo changing path....'
           //  bat 'cd E:\\git\\repo\\demo'
          //   bat 'gradle build'
               bat 'echo builded....'    
            
          }
       }
stage('Sonarqube analysis') {
    steps {
   echo "sonar report"
 
    }
        }
    }
    post { 
        always { 
            script {
          // requires SonarQube Scanner 2.8+
          scannerHome = tool 'SonarQube Scanner 2.8'
        }
  
       
     withSonarQubeEnv('clsd') {
         echo scannerHome
         bat "${scannerHome}/bin/sonar-scanner.bat\
         -Dsonar.projectKey=clsd\
         -Dsonar.projectName=clsd\
         -Dsonar.sources=./demo/src/main/java/com/example/demo\
         -Dsonar.tests=./\
         -Dsonar.test.inclusions=**/*test*/**" 
    }
             echo 'DONE!'
        }
    }
}
